<script>
    async function fetchGameObjects() {
        const response = await fetch('/game_objects/');
        const data = await response.json();

        const container = document.getElementById("game-container");
        container.innerHTML = "";  // 기존 객체 삭제

        function createElement(obj, className) {
            let div = document.createElement("div");
            div.classList.add("game-object", className);
            div.style.left = obj.x + "px";
            div.style.top = obj.y + "px";
            div.style.width = obj.width + "px";
            div.style.height = obj.height + "px";
            container.appendChild(div);
        }

        data.bullets.forEach(bullet => createElement(bullet, "bullet"));
        data.enemies.forEach(enemy => createElement(enemy, "enemy"));
        data.walls.forEach(wall => createElement(wall, "wall"));
        data.ground.forEach(ground => createElement(ground, "ground"));
    }

    async function updateGame() {
        await fetch('/update_game/');
    }

    async function fireBullet() {
        const angle = document.getElementById("angle-input").value;
        await fetch('/fire_bullet/', {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ angle: parseInt(angle, 10) })
        });
    }

    setInterval(fetchGameObjects, 100); // 0.1초마다 게임 객체 업데이트
    setInterval(updateGame, 100); // 0.1초마다 update_game() 호출
</script>
